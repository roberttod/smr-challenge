<!doctype html>
<html class="no-js" lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Qubit - Quick Challenge</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/ace/ace.js"></script>
    <script src="js/ace/theme-monokai.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/ace/mode-javascript.js" type="text/javascript" charset="utf-8"></script>
  </head>
  <body>
    <div class="content">
      <img src='http://qubit.com/sites/all/themes/qubit/img/logo.png' />
      <p>You must write some code which will push the numbers 100 to 1 (inclusive) into an array named 'array'.</p>
      <p>To complete the challenge press CMD + S.</p>
      <p>Your must not change the starter code which looks like:</p>
      <pre>for (var i = 0;</pre>
      <p>Ready?</p>
      <div class='theform'>
        <label for="name">Name</label>
        <input type="text" name="name" id='name' />
        <label for="email">Email</label>
        <input type="email" name="email" id='email' />
        <button class="start">Start</button>
      </div>
      <div class="challenge" style="display: none;">
        <div class='save-msg'>Hit CMD + S to run your code</div>
        <div class='timer'>0 secs</div>
<div id='ace-editor'>(function () {
  var array = [];
    
  /**
   * CODE BELOW HERE
   */

  // AIM OF THE GAME
  // Starting with the beginning of the small for loop below, 
  // without editing what is already there, 
  // push numbers from 100 to 1 inclusive
  // into the array named 'array'


  for (var i=0;

  /**
   * CODE ABOVE HERE
   */
  return array;
})();</div>
        <script>
          var startTime = 0;
          var msTime = 0;
          $(document).ready(function () {

            var name, email;

            $('.start').click(function() {

              var emailRegex = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;

              if (!$('#name').val().length || !$('#email').val().length || !emailRegex.test($('#email').val())) {
                alert("Please put in a name and valid email");
                return false;
              }

              $("html, body").animate({ scrollTop: $(document).height() }, "fast");

              $('.ace_text-input').focus();

              setInterval(function () {
                startTime++;
                $('.timer').text(startTime + " secs");
              }, 1000);

              setInterval(function () {
                msTime++;
              }, 100);

              $('.challenge').show();
            });

          });

          function arraysEqual(arr1, arr2) {
              if(arr1.length !== arr2.length)
                  return false;
              for(var i = arr1.length; i--;) {
                  if(arr1[i] !== arr2[i])
                      return false;
              }

              return true;
          }


          function GoogleForm(opts) {
            this._opts = $.extend({}, GoogleForm.DEFAULTS, opts);
          }

          GoogleForm.DEFAULTS = {
            id: null,
            baseUrl: "https://docs.google.com"
          };

          GoogleForm.prototype.submit = function (data) {

            //Create the iframe
            var iframeName = "qb" + (new Date()).getTime();
            this._$iframe = $("<iframe />", {
              name: iframeName,
              css: { display: "none" }
            }).appendTo("body");

            //Build URL
            var url = this._opts.baseUrl;
            url += "/forms/d/" + this._opts.id + "/formResponse";

            //Create the form
            var $form = this._$form = $("<form />", {
              target: iframeName,
              method: "POST",
              action: url,
              css: { display: "none" }
            }).appendTo("body");

            //Build form
            $.each(data, function (key, value) {
              $("<input />", {
                type: "hidden",
                name: "entry." + key,
                value: value
              }).appendTo($form);
            });

            //Submit the form
            $form.submit();

          };


          var googleForm = new GoogleForm({ id: "1WyaWcQuTDGyUUBI50fzSL42JCzOpwiKEHyaLMD6TVQs" });

          var editor = ace.edit("ace-editor");
          editor.setTheme("ace/theme/twilight");
          var JavaScriptMode = ace.require("ace/mode/javascript").Mode;
          editor.moveCursorTo(14, 15);
          editor.getSession().setMode(new JavaScriptMode());
          var answer = [100, 99, 98, 97, 96, 95, 94, 93, 92, 91, 90, 89, 88, 87, 86, 85, 84, 83, 82, 81, 80, 79, 78, 77, 76, 75, 74, 73, 72, 71, 70, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1];
          editor.commands.addCommand({
              name: 'myCommand',
              bindKey: {win: 'Ctrl-M',  mac: 'Command-S'},
              exec: function(editor) {
                var code = editor.getValue();

                if (code.indexOf("for (var i=0;") === -1) {
                  alert("You changed the starter!");
                  return false;
                }

                try {

                  var value = eval(code);

                  if (arraysEqual(value,answer)) {

                    googleForm.submit({
                      584038464: $('#name').val(),
                      663424153: $('#email').val(),
                      1143816994: msTime,
                      6923730: 1
                    });

                    $('.content').html("<h1>Correct! Your details have been recorded.</h1>");


                  } else {
                    console.log(value);
                    alert("Incorrect output, see console log for more");
                  }

                } catch (e) {
                  alert("Syntax error:" + e);
                }
              },
              readOnly: false
          });
      </script>
      </div>
    </div>
  </body>
</html>